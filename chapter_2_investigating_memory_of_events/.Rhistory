)
) %>%
kable("latex", booktabs = TRUE, escape = FALSE) %>%
kable_styling(font_size = 7)
}
table1 <- make_kable_table(filtered_df %>% slice(1:100))
table2 <- make_kable_table(filtered_df %>% slice(101:200))
table3 <- make_kable_table(filtered_df %>% slice(201:300))
table1
table2
table3
# take the top adjectives unique to men; because there are so many with a max of 2, sample some positives
positive_sample <- comparison %>%
filter(count_diff > 0) %>%
arrange(desc(count_diff)) %>%
top_n(20) %>%
mutate(Category = "Women", Color = "blue")
# take the top adjectives unique to women
negative_sample <- comparison %>%
filter(count_diff < 0) %>%
top_n(-20) %>%
mutate(Category = "Men", Color = "red")
# combine men and women
filtered_df <- negative_sample %>%
bind_rows(positive_sample) %>%
mutate(adjective = fct_reorder(adjective, count_diff)) %>%
arrange(desc(count_diff)) %>%
select(adjective, count_diff, Category, Color) %>%
arrange(desc(abs(count_diff))) %>%
mutate(adjective = fct_reorder(adjective, count_diff))
make_kable_table <- function(data_slice) {
data_slice %>%
mutate(
Category = ifelse(
Category == "Women",
"\\textcolor{blue}{Women}",
"\\textcolor{red}{Men}"
)
) %>%
kable(
"latex",
booktabs = TRUE,
escape = FALSE,
col.names = c("Adjective", "Count Difference", "Used More About")
) %>%
kable_styling(font_size = 7)
}
table1 <- make_kable_table(filtered_df %>% slice(1:100))
View(filtered_df)
# take the top adjectives unique to men; because there are so many with a max of 2, sample some positives
positive_sample <- comparison %>%
filter(count_diff > 0) %>%
arrange(desc(count_diff)) %>%
top_n(20) %>%
mutate(Category = "Women", Color = "blue")
# take the top adjectives unique to women
negative_sample <- comparison %>%
filter(count_diff < 0) %>%
top_n(-20) %>%
mutate(Category = "Men", Color = "red")
# combine men and women
filtered_df <- negative_sample %>%
bind_rows(positive_sample) %>%
mutate(adjective = fct_reorder(adjective, count_diff)) %>%
arrange(desc(count_diff)) %>%
select(adjective, count_diff, Category, Color) %>%
arrange(desc(abs(count_diff))) %>%
mutate(adjective = fct_reorder(adjective, count_diff))
make_kable_table <- function(data_slice) {
data_slice %>%
mutate(
Category = ifelse(
Category == "Women",
"\\textcolor{blue}{Women}",
"\\textcolor{red}{Men}"
)
) %>%
kable(
"latex",
booktabs = TRUE,
escape = FALSE,
col.names = c("Adjective", "Count Difference", "Category", "Color")
) %>%
kable_styling(font_size = 7)
}
table1 <- make_kable_table(filtered_df %>% slice(1:100))
table2 <- make_kable_table(filtered_df %>% slice(101:200))
table3 <- make_kable_table(filtered_df %>% slice(201:300))
table1
table2
table3
table3
# take the top adjectives unique to men; because there are so many with a max of 2, sample some positives
positive_sample <- comparison %>%
filter(count_diff > 0) %>%
arrange(desc(count_diff)) %>%
top_n(20) %>%
mutate(Category = "Women", Color = "blue")
# take the top adjectives unique to women
negative_sample <- comparison %>%
filter(count_diff < 0) %>%
top_n(-20) %>%
mutate(Category = "Men", Color = "red")
# combine men and women
filtered_df <- negative_sample %>%
bind_rows(positive_sample) %>%
mutate(adjective = fct_reorder(adjective, count_diff)) %>%
arrange(desc(count_diff)) %>%
select(adjective, count_diff, Category, Color) %>%
arrange(desc(abs(count_diff))) %>%
mutate(adjective = fct_reorder(adjective, count_diff))
make_kable_table <- function(data_slice) {
data_slice %>%
mutate(
`Used More About` = if_else(
Category == "Women",
cell_spec(Category, format = "latex", color = "blue"),
cell_spec(Category, format = "latex", color = "red")
)
) %>%
select(
Adjective        = adjective,
`Count Difference` = count_diff,
`Used More About`
) %>%
kable(
format   = "latex",
booktabs = TRUE,
escape   = FALSE
) %>%
kable_styling(
full_width = FALSE,
position   = "center",
font_size  = 7
)
}
table1 <- make_kable_table(filtered_df %>%
slice(1:100))
table2 <- make_kable_table(filtered_df %>%
slice(101:200))
table3 <- make_kable_table(filtered_df %>%
slice(201:300))
table1
table2
table3
# take the top adjectives unique to men; because there are so many with a max of 2, sample some positives
positive_sample <- comparison %>%
filter(count_diff > 0) %>%
arrange(desc(count_diff)) %>%
top_n(20) %>%
mutate(Category = "Women", Color = "blue")
# take the top adjectives unique to women
negative_sample <- comparison %>%
filter(count_diff < 0) %>%
top_n(-20) %>%
mutate(Category = "Men", Color = "red")
# combine men and women
filtered_df <- negative_sample %>%
bind_rows(positive_sample) %>%
mutate(adjective = fct_reorder(adjective, count_diff)) %>%
arrange(desc(count_diff)) %>%
select(adjective, count_diff, Category, Color) %>%
arrange(desc(abs(count_diff))) %>%
mutate(adjective = fct_reorder(adjective, count_diff))
make_kable_table <- function(data_slice) {
data_slice %>%
mutate(
`Used More About` = if_else(
Category == "Women",
cell_spec(Category, format = "latex", color = "blue"),
cell_spec(Category, format = "latex", color = "red")
)
) %>%
select(
Adjective        = adjective,
`Count Difference` = count_diff,
`Used More About`
) %>%
kable(
format   = "latex",
booktabs = TRUE,
escape   = FALSE
) %>%
kable_styling(
full_width = FALSE,
position   = "center",
font_size  = 7
)
}
table1 <- make_kable_table(filtered_df %>%
slice(1:100))
table2 <- make_kable_table(filtered_df %>%
slice(101:200))
table3 <- make_kable_table(filtered_df %>%
slice(201:300))
table1
table2
table3
# take the top adjectives unique to men; because there are so many with a max of 2, sample some positives
positive_sample <- comparison %>%
filter(count_diff > 0) %>%
arrange(desc(count_diff)) %>%
top_n(20) %>%
mutate(Category = "Women", Color = "blue")
# take the top adjectives unique to women
negative_sample <- comparison %>%
filter(count_diff < 0) %>%
top_n(-20) %>%
mutate(Category = "Men", Color = "red")
# combine men and women
filtered_df <- negative_sample %>%
bind_rows(positive_sample) %>%
mutate(adjective = fct_reorder(adjective, count_diff)) %>%
arrange(desc(count_diff)) %>%
select(adjective, count_diff, Category, Color) %>%
arrange(desc(abs(count_diff))) %>%
mutate(adjective = fct_reorder(adjective, count_diff))
make_kable_table <- function(data_slice) {
data_slice %>%
mutate(
`Used More About` = if_else(
Category == "Women",
cell_spec(Category, format = "latex", color = "blue"),
cell_spec(Category, format = "latex", color = "red")
)
) %>%
select(
Adjective        = adjective,
`Count Difference` = count_diff,
`Used More About`
) %>%
kable(
format   = "latex",
booktabs = TRUE,
escape   = FALSE
) %>%
kable_styling(
full_width = FALSE,
position   = "center",
font_size  = 7
)
}
table1 <- make_kable_table(filtered_df %>%
slice(1:100))
table2 <- make_kable_table(filtered_df %>%
slice(101:200))
table3 <- make_kable_table(filtered_df %>%
slice(201:300))
table1
table2
table3
table3
# top adjectives used more about women (count_diff > 0)
positive_sample <- comparison %>%
filter(count_diff > 0) %>%
slice_max(order_by = count_diff, n = 20) %>%
mutate(Category = "Women")
# top adjectives used more about men (count_diff < 0)
#negative_sample <- comparison %>%
#  filter(count_diff < 0) %>%
#  slice_min(order_by = count_diff, n = 20) %>%
#  mutate(Category = "Men")
# combine, with Women first and all Women rows together
#filtered_df <- bind_rows(positive_sample, negative_sample) %>%
#  mutate(
#    Category = factor(Category, levels = c("Women", "Men")),
#    adjective = fct_reorder(adjective, count_diff)
#  ) %>%
#  arrange(Category, desc(abs(count_diff))) %>%
#  select(adjective, count_diff, Category)
#make_kable_table <- function(data_slice) {
#  data_slice %>%
#    mutate(
#      UsedMoreAbout = if_else(
#        Category == "Women",
#        cell_spec(Category, format = "latex", color = "blue"),
#        cell_spec(Category, format = "latex", color = "red"))) %>%
#    select(
#      Adjective = adjective,
#      `Count Difference` = count_diff,
#      `Used More About` = UsedMoreAbout    # Category not shown, just used for color
#    ) %>%
#    kable(
#      format = "latex",
#      booktabs = TRUE,
#      escape = FALSE
#    ) %>%
#    kable_styling(full_width = FALSE, position = "center")
#}
# ---- Create slices (adjust ranges as needed) ----
# If you have fewer rows, make these smaller (e.g., 1:20, 21:40, etc.)
#table1 <- make_kable_table(filtered_df %>% slice(1:200))
#table2 <- make_kable_table(filtered_df %>% slice(201:400))
#table3 <- make_kable_table(filtered_df %>% slice(401:600))
# In your Rmd, print them in separate chunks, e.g.:
# ```{r}
# table1
# ```
# ```{r}
# table2
# ```
# ```{r}
# table3
# ```
# top adjectives used more about women (count_diff > 0)
positive_sample <- comparison %>%
filter(count_diff > 0) %>%
slice_max(order_by = count_diff, n = 20) %>%
mutate(Category = "Women")
# top adjectives used more about men (count_diff < 0)
negative_sample <- comparison %>%
filter(count_diff < 0) %>%
slice_min(order_by = count_diff, n = 20) %>%
mutate(Category = "Men")
# combine, with Women first and all Women rows together
#filtered_df <- bind_rows(positive_sample, negative_sample) %>%
#  mutate(
#    Category = factor(Category, levels = c("Women", "Men")),
#    adjective = fct_reorder(adjective, count_diff)
#  ) %>%
#  arrange(Category, desc(abs(count_diff))) %>%
#  select(adjective, count_diff, Category)
#make_kable_table <- function(data_slice) {
#  data_slice %>%
#    mutate(
#      UsedMoreAbout = if_else(
#        Category == "Women",
#        cell_spec(Category, format = "latex", color = "blue"),
#        cell_spec(Category, format = "latex", color = "red"))) %>%
#    select(
#      Adjective = adjective,
#      `Count Difference` = count_diff,
#      `Used More About` = UsedMoreAbout    # Category not shown, just used for color
#    ) %>%
#    kable(
#      format = "latex",
#      booktabs = TRUE,
#      escape = FALSE
#    ) %>%
#    kable_styling(full_width = FALSE, position = "center")
#}
# ---- Create slices (adjust ranges as needed) ----
# If you have fewer rows, make these smaller (e.g., 1:20, 21:40, etc.)
#table1 <- make_kable_table(filtered_df %>% slice(1:200))
#table2 <- make_kable_table(filtered_df %>% slice(201:400))
#table3 <- make_kable_table(filtered_df %>% slice(401:600))
# In your Rmd, print them in separate chunks, e.g.:
# ```{r}
# table1
# ```
# ```{r}
# table2
# ```
# ```{r}
# table3
# ```
# top adjectives used more about women (count_diff > 0)
positive_sample <- comparison %>%
filter(count_diff > 0) %>%
slice_max(order_by = count_diff, n = 20) %>%
mutate(Category = "Women")
# top adjectives used more about men (count_diff < 0)
negative_sample <- comparison %>%
filter(count_diff < 0) %>%
slice_min(order_by = count_diff, n = 20) %>%
mutate(Category = "Men")
# combine, with Women first and all Women rows together
filtered_df <- bind_rows(positive_sample, negative_sample) %>%
mutate(
Category = factor(Category, levels = c("Women", "Men")),
adjective = fct_reorder(adjective, count_diff)
) %>%
arrange(Category, desc(abs(count_diff))) %>%
select(adjective, count_diff, Category)
#make_kable_table <- function(data_slice) {
#  data_slice %>%
#    mutate(
#      UsedMoreAbout = if_else(
#        Category == "Women",
#        cell_spec(Category, format = "latex", color = "blue"),
#        cell_spec(Category, format = "latex", color = "red"))) %>%
#    select(
#      Adjective = adjective,
#      `Count Difference` = count_diff,
#      `Used More About` = UsedMoreAbout    # Category not shown, just used for color
#    ) %>%
#    kable(
#      format = "latex",
#      booktabs = TRUE,
#      escape = FALSE
#    ) %>%
#    kable_styling(full_width = FALSE, position = "center")
#}
# ---- Create slices (adjust ranges as needed) ----
# If you have fewer rows, make these smaller (e.g., 1:20, 21:40, etc.)
#table1 <- make_kable_table(filtered_df %>% slice(1:200))
#table2 <- make_kable_table(filtered_df %>% slice(201:400))
#table3 <- make_kable_table(filtered_df %>% slice(401:600))
# In your Rmd, print them in separate chunks, e.g.:
# ```{r}
# table1
# ```
# ```{r}
# table2
# ```
# ```{r}
# table3
# ```
# top adjectives used more about women (count_diff > 0)
positive_sample <- comparison %>%
filter(count_diff > 0) %>%
slice_max(order_by = count_diff, n = 20) %>%
mutate(Category = "Women")
# top adjectives used more about men (count_diff < 0)
negative_sample <- comparison %>%
filter(count_diff < 0) %>%
slice_min(order_by = count_diff, n = 20) %>%
mutate(Category = "Men")
# combine, with Women first and all Women rows together
filtered_df <- bind_rows(positive_sample, negative_sample) %>%
mutate(
Category = factor(Category, levels = c("Women", "Men")),
adjective = fct_reorder(adjective, count_diff)
) %>%
arrange(Category, desc(abs(count_diff))) %>%
select(adjective, count_diff, Category)
make_kable_table <- function(data_slice) {
data_slice %>%
mutate(
UsedMoreAbout = if_else(
Category == "Women",
cell_spec(Category, format = "latex", color = "blue"),
cell_spec(Category, format = "latex", color = "red"))) %>%
select(
Adjective = adjective,
`Count Difference` = count_diff,
`Used More About` = UsedMoreAbout    # Category not shown, just used for color
) %>%
kable(
format = "latex",
booktabs = TRUE,
escape = FALSE
) %>%
kable_styling(full_width = FALSE, position = "center")
}
# ---- Create slices (adjust ranges as needed) ----
# If you have fewer rows, make these smaller (e.g., 1:20, 21:40, etc.)
#table1 <- make_kable_table(filtered_df %>% slice(1:200))
#table2 <- make_kable_table(filtered_df %>% slice(201:400))
#table3 <- make_kable_table(filtered_df %>% slice(401:600))
# In your Rmd, print them in separate chunks, e.g.:
# ```{r}
# table1
# ```
# ```{r}
# table2
# ```
# ```{r}
# table3
# ```
# top adjectives used more about women (count_diff > 0)
positive_sample <- comparison %>%
filter(count_diff > 0) %>%
slice_max(order_by = count_diff, n = 20) %>%
mutate(Category = "Women")
# top adjectives used more about men (count_diff < 0)
negative_sample <- comparison %>%
filter(count_diff < 0) %>%
slice_min(order_by = count_diff, n = 20) %>%
mutate(Category = "Men")
# combine, with Women first and all Women rows together
filtered_df <- bind_rows(positive_sample, negative_sample) %>%
mutate(
Category = factor(Category, levels = c("Women", "Men")),
adjective = fct_reorder(adjective, count_diff)
) %>%
arrange(Category, desc(abs(count_diff))) %>%
select(adjective, count_diff, Category)
make_kable_table <- function(data_slice) {
data_slice %>%
mutate(
UsedMoreAbout = if_else(
Category == "Women",
cell_spec(Category, format = "latex", color = "blue"),
cell_spec(Category, format = "latex", color = "red"))) %>%
select(
Adjective = adjective,
`Count Difference` = count_diff,
`Used More About` = UsedMoreAbout    # Category not shown, just used for color
) %>%
kable(
format = "latex",
booktabs = TRUE,
escape = FALSE
) %>%
kable_styling(full_width = FALSE, position = "center")
}
# ---- Create slices (adjust ranges as needed) ----
# If you have fewer rows, make these smaller (e.g., 1:20, 21:40, etc.)
table1 <- make_kable_table(filtered_df %>% slice(1:200))
table2 <- make_kable_table(filtered_df %>% slice(201:400))
table3 <- make_kable_table(filtered_df %>% slice(401:600))
# In your Rmd, print them in separate chunks, e.g.:
# ```{r}
table1
# ```
# ```{r}
# table2
# ```
# ```{r}
# table3
# ```

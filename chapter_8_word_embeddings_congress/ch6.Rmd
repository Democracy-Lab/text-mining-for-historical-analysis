---
title: "ch6"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Word Embeddings of Congress

I could create just the climate change corpus


As the book’s narrative continues its theme of critically reflecting upon both data and algorithms, we will weigh the positive aspects of using word embeddings against their negative aspect, which is that they are a “black box” in the sense that the machine learning model that produces the analysis cannot be unpacked.   


The output is a dataframe with the top words for each keyword ("climate", "woman", "environmentalist", and "government")

```{r}
library('text2vec')
library('dplyr')

#### temp 
congress_climate_1 <- as.matrix(read.table("~/Downloads/word_embeddings/congress_climate_2001_2001.txt", as.is = TRUE))
congress_climate_2 <- as.matrix(read.table("~/Downloads/word_embeddings/congress_climate_2021_2021.txt", as.is = TRUE))
#congress_climate <- bind_rows(word_vectors, word_vectors_1)

############

keywords <- c("climate")#, "woman", "environmentalist", "government")
keyword <- "climate"
years <- c(2001, 2021)


#for(year in years) {
  kw = congress_climate_1["climate", , drop = F]
  
  cos_sim_rom = sim2(x = congress_climate_1, y = kw, method = "cosine", norm = "l2")
  
  similarity = sort(cos_sim_rom[,1], decreasing = TRUE)
  
  most_similar_df_1 <- as.data.frame(similarity, decreasing = T) %>%
    slice(2:21) #%>%
    #mutate(year = paste0(year))
  
  #}
  kw = congress_climate_2["climate", , drop = F]
  
  cos_sim_rom = sim2(x = congress_climate_2, y = kw, method = "cosine", norm = "l2")
  
  similarity = sort(cos_sim_rom[,1], decreasing = TRUE)
  
  most_similar_df_2 <- as.data.frame(similarity, decreasing = T) %>%
    slice(2:21) #%>%
    #mutate(year = paste0(year))


    #   mutate(keyword = paste0(keyword))
    # 
   # most_similar_df$word <- rownames(most_similar_df) 
    # 
    # word_embeddings_climate <- bind_rows(word_embeddings_climate, most_similar_df) 
    
    #} }
```


```{r, eval = F}
library('knitr')
library('kableExtra')

kables(list(kable(caption = "Words Most Related to \"Climate\": Searching the 2001 Congressional Records",
                  most_similar_df_1) %>% 
              kable_styling(),
            kable(caption = "Words Most Related to \"Climate\": Searching the 2021 Congressional Records",
                  most_similar_df_2) %>% 
              kable_styling())) %>% 
  kable_styling()
```

```{r, echo = F}
library('knitr')
library('kableExtra')

kables(list(kable(caption = "Words Most Related to \"Climate\" in the 2001 Congressional Records",
                  most_similar_df_1) %>% 
              kable_styling(),
            kable(caption = "Words Most Related to \"Climate\" in the 2001 Congressional Records",
                  most_similar_df_2) %>% 
              kable_styling())) %>% 
  kable_styling()
```


